<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>RabbitMQ AMQP 1.0 Java Client</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>RabbitMQ AMQP 1.0 Java Client</h1>
<div class="details">
<span id="revnumber">version 0.8.0-SNAPSHOT</span>
<br><span id="revremark">(26cf71b)</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#pre-requisites">Pre-requisites</a></li>
<li><a href="#license">License</a></li>
<li><a href="#dependencies">Dependencies</a>
<ul class="sectlevel2">
<li><a href="#maven">Maven</a></li>
<li><a href="#gradle">Gradle</a></li>
<li><a href="#snapshots">Snapshots</a></li>
</ul>
</li>
<li><a href="#versioning">Versioning</a></li>
<li><a href="#stability-of-programming-interfaces">Stability of Programming Interfaces</a></li>
<li><a href="#api-overview">Overview</a></li>
<li><a href="#advanced-usage">Advanced Usage</a>
<ul class="sectlevel2">
<li><a href="#connection-settings-at-the-environment-level">Connection Settings at the Environment Level</a></li>
<li><a href="#settling-messages-in-batch">Settling Messages in Batch</a></li>
<li><a href="#subscription-listener">Subscription Listener</a></li>
<li><a href="#oauth-2-support">OAuth 2 Support</a></li>
<li><a href="#metrics-collection">Metrics Collection</a></li>
<li><a href="#requestresponse">Request/Response</a></li>
</ul>
</li>
<li><a href="#micrometer-observation">Appendix A: Micrometer Observation</a>
<ul class="sectlevel2">
<li><a href="#observability-conventions">Observability - Conventions</a></li>
<li><a href="#observability-spans">Observability - Spans</a>
<ul class="sectlevel3">
<li><a href="#observability-spans-process-observation">Process Observation Span</a></li>
<li><a href="#observability-spans-publish-observation">Publish Observation Span</a></li>
</ul>
</li>
<li><a href="#observability-metrics">Observability - Metrics</a>
<ul class="sectlevel3">
<li><a href="#observability-metrics-process-observation">Process Observation</a></li>
<li><a href="#observability-metrics-publish-observation">Publish Observation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The RabbitMQ AMQP 1.0 Java Client is a library to communicate with RabbitMQ using <a href="https://www.rabbitmq.com/docs/amqp">AMQP 1.0</a>.</p>
</div>
<div class="paragraph">
<p>It is <strong>for RabbitMQ only</strong>, it does not support other brokers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pre-requisites"><a class="anchor" href="#pre-requisites"></a>Pre-requisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library requires at least Java 11 (Java 21+ is recommended) and RabbitMQ 4.0 or more.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="license"><a class="anchor" href="#license"></a>License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The library is open source, developed <a href="https://github.com/rabbitmq/rabbitmq-amqp-java-client/">on GitHub</a>, and is licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache Public License 2.0</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dependencies"><a class="anchor" href="#dependencies"></a>Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use your favorite build management tool to add the client dependencies to your project.</p>
</div>
<div class="sect2">
<h3 id="maven"><a class="anchor" href="#maven"></a>Maven</h3>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dependencies&gt;</span>

  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.rabbitmq.client<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>amqp-client<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>0.8.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Snapshots require to declare the <a href="#snapshots">appropriate repository</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="gradle"><a class="anchor" href="#gradle"></a>Gradle</h3>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
  <span class="n">compile</span> <span class="s2">"com.rabbitmq.client:amqp-client:0.8.0-SNAPSHOT"</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Snapshots require to declare the <a href="#snapshots">appropriate repository</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="snapshots"><a class="anchor" href="#snapshots"></a>Snapshots</h3>
<div class="paragraph">
<p>Releases are available from Maven Central, which does not require specific declaration.
Snapshots are available from a repository which must be declared in the dependency management configuration.</p>
</div>
<div class="paragraph">
<p>With Maven:</p>
</div>
<div class="listingblock">
<div class="title">Snapshot repository declaration for Maven</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;repositories&gt;</span>

  <span class="nt">&lt;repository&gt;</span>
    <span class="nt">&lt;id&gt;</span>central-portal-snapshots<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;url&gt;</span>https://central.sonatype.com/repository/maven-snapshots/<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;snapshots&gt;&lt;enabled&gt;</span>true<span class="nt">&lt;/enabled&gt;&lt;/snapshots&gt;</span>
    <span class="nt">&lt;releases&gt;&lt;enabled&gt;</span>false<span class="nt">&lt;/enabled&gt;&lt;/releases&gt;</span>
  <span class="nt">&lt;/repository&gt;</span>

<span class="nt">&lt;/repositories&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With Gradle:</p>
</div>
<div class="listingblock">
<div class="title">Snapshot repository declaration for Gradle:</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">repositories</span> <span class="o">{</span>
  <span class="n">maven</span> <span class="o">{</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">'Central Portal Snapshots'</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">'https://central.sonatype.com/repository/maven-snapshots/'</span>
    <span class="c1">// Only search this repository for the specific dependency</span>
    <span class="n">content</span> <span class="o">{</span>
      <span class="n">includeModule</span><span class="o">(</span><span class="s2">"com.rabbitmq.client"</span><span class="o">,</span> <span class="s2">"amqp-client"</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="n">mavenCentral</span><span class="o">()</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="versioning"><a class="anchor" href="#versioning"></a>Versioning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RabbitMQ AMQP 1.0 Java Client is in development and stabilization phase.
When the stabilization phase ends, a 1.0.0 version will be cut, and
<a href="https://semver.org/">semantic versioning</a> is likely to be enforced.</p>
</div>
<div class="paragraph">
<p>Before reaching the stable phase, the client will use a versioning scheme of <code>[0.MINOR.PATCH]</code> where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>0</code> indicates the project is still in a stabilization phase.</p>
</li>
<li>
<p><code>MINOR</code> is a 0-based number incrementing with each new release cycle. It generally reflects significant changes like new features and potentially some programming interfaces changes.</p>
</li>
<li>
<p><code>PATCH</code> is a 0-based number incrementing with each service release, that is bux fixes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Breaking changes between releases can happen but will be kept to a minimum.
The next section provides more details about the evolution of programming interfaces.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stability-of-programming-interfaces"><a class="anchor" href="#stability-of-programming-interfaces"></a>Stability of Programming Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RabbitMQ AMQP 1.0 Java Client is in active development but its programming interfaces will remain as stable as possible. There is no guarantee though that they will remain completely stable, at least until it reaches version 1.0.0.</p>
</div>
<div class="paragraph">
<p>The client contains 2 sets of programming interfaces whose stability are of interest for application developers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Application Programming Interfaces (API): those are the ones used to write application logic.
They include the interfaces and classes in the <code>com.rabbitmq.client.amqp</code> package (e.g. <code>Connection</code>, <code>Publisher</code>, <code>Consumer</code>, <code>Message</code>).
These API constitute the main programming model of the client and will be kept as stable as possible.</p>
</li>
<li>
<p>Service Provider Interfaces (SPI): those are interfaces to implement mainly technical behavior in the client.
They are not meant to be used to implement application logic.
Application developers may have to refer to them in the configuration phase and if they want to customize some internal behavior of the client.
SPI packages and interfaces are marked as such in their Javadoc.
<em>These SPI are susceptible to change, but this should have no impact on most applications</em>, as the changes are likely to be limited to the client internals.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-overview"><a class="anchor" href="#api-overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RabbitMQ team maintains a set of AMQP 1.0 client libraries designed and optimized for RabbitMQ.
They offer a simple and safe, yet powerful API on top of AMQP 1.0. Applications can publish and consume messages with these libraries, as well as manage the server topology in a consistent way across programming languages.
The libraries also offer advanced features like automatic connection and topology recovery, and connection affinity with queues.</p>
</div>
<div class="paragraph">
<p>The RabbitMQ AMQP 1.0 Java Client is one of these libraries.
This documentation covers only the advanced usage of the library; a <a href="https://www.rabbitmq.com/client-libraries/amqp-client-libraries">common page on the RabbitMQ website</a> covers the most common use cases.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="advanced-usage"><a class="anchor" href="#advanced-usage"></a>Advanced Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="connection-settings-at-the-environment-level"><a class="anchor" href="#connection-settings-at-the-environment-level"></a>Connection Settings at the Environment Level</h3>
<div class="paragraph">
<p>Connection settings (URI, credentials, etc.) can be set at the environment level.
They will then be re-used for each connection.
It is possible to override the environment connection settings for a given connection:</p>
</div>
<div class="listingblock">
<div class="title">Connection settings at the environment and connection levels</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AmqpEnvironmentBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">connectionSettings</span><span class="o">()</span>
    <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"amqp://guest:guest@localhost:5672/%2f"</span><span class="o">)</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="o">.</span><span class="na">environmentBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

<span class="nc">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="na">connectionBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"amqp://admin:admin@localhost:5672/%2f"</span><span class="o">)</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use the <code>guest</code> user by default</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use the <code>admin</code> user for this connection</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="settling-messages-in-batch"><a class="anchor" href="#settling-messages-in-batch"></a>Settling Messages in Batch</h3>
<div class="listingblock">
<div class="title">Settling messages in batch</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kt">int</span> <span class="n">batchSize</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
<span class="nc">Consumer</span><span class="o">.</span><span class="na">MessageHandler</span> <span class="n">handler</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Consumer</span><span class="o">.</span><span class="na">MessageHandler</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">volatile</span> <span class="nc">Consumer</span><span class="o">.</span><span class="na">BatchContext</span> <span class="n">batch</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>  <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Consumer</span><span class="o">.</span><span class="na">Context</span> <span class="n">context</span><span class="o">,</span> <span class="nc">Message</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">batch</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">batch</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">batch</span><span class="o">(</span><span class="n">batchSize</span><span class="o">);</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">}</span>
    <span class="kt">boolean</span> <span class="n">success</span> <span class="o">=</span> <span class="n">process</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">success</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">batch</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>  <i class="conum" data-value="3"></i><b>(3)</b>
      <span class="k">if</span> <span class="o">(</span><span class="n">batch</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="n">batchSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">batch</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>  <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="n">batch</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>  <i class="conum" data-value="5"></i><b>(5)</b>
      <span class="o">}</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">context</span><span class="o">.</span><span class="na">discard</span><span class="o">();</span>  <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">};</span>
<span class="nc">Consumer</span> <span class="n">consumer</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">consumerBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">queue</span><span class="o">(</span><span class="s">"some-queue"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">messageHandler</span><span class="o">(</span><span class="n">handler</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declare batch context property</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create a new batch context instance</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Add the current message context to the batch context if processing is successful</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Settle the batch context once it contains 10 messages</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Reset the batch context</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Discard the current message context if processing fails</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="subscription-listener"><a class="anchor" href="#subscription-listener"></a>Subscription Listener</h3>
<div class="paragraph">
<p>The client provides a <code>SubscriptionListener</code> interface callback to add behavior before a subscription is created.
This callback is meant for stream consumers: it can be used to dynamically set the offset the consumer attaches to in the stream.
It is called when the consumer is first created and when the client has to re-subscribe (e.g. after a disconnection).</p>
</div>
<div class="paragraph">
<p>It is possible to use the callback to get the last processed offset from an external store.
The following code snippet shows how this can be done (note the interaction with the external store is not detailed):</p>
</div>
<div class="listingblock">
<div class="title">Using the subscription listener to attach to a stream</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="n">connection</span><span class="o">.</span><span class="na">consumerBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">queue</span><span class="o">(</span><span class="s">"some-stream"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">subscriptionListener</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>  <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="kt">long</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">getOffsetFromExternalStore</span><span class="o">();</span>  <i class="conum" data-value="2"></i><b>(2)</b>
      <span class="n">ctx</span><span class="o">.</span><span class="na">streamOptions</span><span class="o">().</span><span class="na">offset</span><span class="o">(</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>  <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="o">})</span>
    <span class="o">.</span><span class="na">messageHandler</span><span class="o">((</span><span class="n">ctx</span><span class="o">,</span> <span class="n">msg</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="c1">// message handling code...</span>

      <span class="kt">long</span> <span class="n">offset</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="n">msg</span><span class="o">.</span><span class="na">annotation</span><span class="o">(</span><span class="s">"x-stream-offset"</span><span class="o">);</span>  <i class="conum" data-value="4"></i><b>(4)</b>
      <span class="n">storeOffsetInExternalStore</span><span class="o">(</span><span class="n">offset</span><span class="o">);</span>  <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="o">})</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set subscription listener</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Get offset from external store</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set offset to use for the subscription</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Get the message offset</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Store the offset in the external store after processing</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="oauth-2-support"><a class="anchor" href="#oauth-2-support"></a>OAuth 2 Support</h3>
<div class="paragraph">
<p>The client can authenticate against an OAuth 2 server like <a href="https://github.com/cloudfoundry/uaa">UAA</a>.
It uses the <a href="https://tools.ietf.org/html/rfc6749#section-4.4">OAuth 2 Client Credentials flow</a>.
The <a href="https://www.rabbitmq.com/docs/oauth2">OAuth 2 plugin</a> must be enabled on the server side and configured to use the same OAuth 2 server as the client.</p>
</div>
<div class="paragraph">
<p>How to retrieve the OAuth 2 token can be globally configured at the environment level:</p>
</div>
<div class="listingblock">
<div class="title">Configuring OAuth 2 token retrieval</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AmqpEnvironmentBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">connectionSettings</span><span class="o">().</span><span class="na">oauth2</span><span class="o">()</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="o">.</span><span class="na">tokenEndpointUri</span><span class="o">(</span><span class="s">"https://localhost:8443/uaa/oauth/token/"</span><span class="o">)</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">.</span><span class="na">clientId</span><span class="o">(</span><span class="s">"rabbitmq"</span><span class="o">).</span><span class="na">clientSecret</span><span class="o">(</span><span class="s">"rabbitmq"</span><span class="o">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="o">.</span><span class="na">grantType</span><span class="o">(</span><span class="s">"password"</span><span class="o">)</span>  <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="o">.</span><span class="na">parameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">,</span> <span class="s">"rabbit_super"</span><span class="o">)</span>  <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="o">.</span><span class="na">parameter</span><span class="o">(</span><span class="s">"password"</span><span class="o">,</span> <span class="s">"rabbit_super"</span><span class="o">)</span>  <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="o">.</span><span class="na">tls</span><span class="o">().</span><span class="na">sslContext</span><span class="o">(</span><span class="n">sslContext</span><span class="o">).</span><span class="na">oauth2</span><span class="o">()</span>  <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="o">.</span><span class="na">shared</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>  <i class="conum" data-value="7"></i><b>(7)</b>
    <span class="o">.</span><span class="na">connection</span><span class="o">()</span>
    <span class="o">.</span><span class="na">environmentBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Access the OAuth 2 configuration</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the token endpoint URI</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Authenticate the client application</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Set the grant type</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Set optional parameters (depends on the OAuth 2 server)</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Set the SSL context (e.g. to verify and trust the identity of the OAuth 2 server)</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The token can be shared across the environment connections</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The environment retrieves tokens and uses them to create AMQP connections.
It also takes care of refreshing the tokens before they expire and of re-authenticating existing connections so the broker does not close them when their token expires.</p>
</div>
<div class="paragraph">
<p>The environment uses the same token for all the connections it maintains by default, but this can be changed by setting the <code>shared</code> flag to <code>false</code>.
With <code>shared = false</code>, each connection will have its own OAuth 2 token.</p>
</div>
<div class="paragraph">
<p>The OAuth 2 configuration can be set at the environment level but also at the connection level.</p>
</div>
</div>
<div class="sect2">
<h3 id="metrics-collection"><a class="anchor" href="#metrics-collection"></a>Metrics Collection</h3>
<div class="paragraph">
<p>The library provides the <a href="https://rabbitmq.github.io/rabbitmq-amqp-java-client/snapshot/api/com/rabbitmq/client/amqp/metrics/MetricsCollector.html"><code>MetricsCollector</code></a> abstraction to collect metrics.
A <code>MetricsCollector</code> instance is set at the environment level and is called in several places by the library.
The underlying implementation can then collect, compute and expose metrics.</p>
</div>
<div class="paragraph">
<p>The library provides the <code>MicrometerMetricsCollector</code>, an implementation based on <a href="https://micrometer.io/">Micrometer</a>.
Micrometer is a façade for observability systems: the user can choose the Micrometer meter registry for their favorite system.</p>
</div>
<div class="paragraph">
<p>Here is how to set up the Micrometer metrics collector and configure it for Prometheus:</p>
</div>
<div class="listingblock">
<div class="title">Setting metrics collection with Prometheus</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">PrometheusMeterRegistry</span> <span class="n">registry</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PrometheusMeterRegistry</span><span class="o">(</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="nc">PrometheusConfig</span><span class="o">.</span><span class="na">DEFAULT</span>
<span class="o">);</span>
<span class="nc">MetricsCollector</span> <span class="n">collector</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MicrometerMetricsCollector</span><span class="o">(</span><span class="n">registry</span><span class="o">);</span> <i class="conum" data-value="2"></i><b>(2)</b>

<span class="nc">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AmqpEnvironmentBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">metricsCollector</span><span class="o">(</span><span class="n">collector</span><span class="o">)</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="nc">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="na">connectionBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span> <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the Micrometer meter registry for Prometheus</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create the metrics collector with the registry</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set the metrics collector in the environment builder</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Create a connection, a Micrometer gauge is incremented</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following metrics are recorded:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the number of open connections</p>
</li>
<li>
<p>the number of open publishers</p>
</li>
<li>
<p>the number of open consumers</p>
</li>
<li>
<p>the total number of published messages</p>
</li>
<li>
<p>the total number of accepted published messages</p>
</li>
<li>
<p>the total number of rejected published messages</p>
</li>
<li>
<p>the total number of released published messages</p>
</li>
<li>
<p>the total number of consumed messages</p>
</li>
<li>
<p>the total number of accepted consumed messages</p>
</li>
<li>
<p>the total number of requeued consumed messages</p>
</li>
<li>
<p>the total number of discarded consumed messages</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example of the Prometheus output:</p>
</div>
<div class="listingblock">
<div class="title">Example of the Prometheus output</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="prometheus"><span class="c"># HELP rabbitmq_amqp_connections</span>
<span class="c"># TYPE rabbitmq_amqp_connections gauge</span>
<span class="n">rabbitmq_amqp_connections</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_consumed_total</span>
<span class="c"># TYPE rabbitmq_amqp_consumed_total counter</span>
<span class="n">rabbitmq_amqp_consumed_total</span> <span class="mf">3.0</span>
<span class="c"># HELP rabbitmq_amqp_consumed_accepted_total</span>
<span class="c"># TYPE rabbitmq_amqp_consumed_accepted_total counter</span>
<span class="n">rabbitmq_amqp_consumed_accepted_total</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_consumed_discarded_total</span>
<span class="c"># TYPE rabbitmq_amqp_consumed_discarded_total counter</span>
<span class="n">rabbitmq_amqp_consumed_discarded_total</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_consumed_requeued_total</span>
<span class="c"># TYPE rabbitmq_amqp_consumed_requeued_total counter</span>
<span class="n">rabbitmq_amqp_consumed_requeued_total</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_consumers</span>
<span class="c"># TYPE rabbitmq_amqp_consumers gauge</span>
<span class="n">rabbitmq_amqp_consumers</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_published_total</span>
<span class="c"># TYPE rabbitmq_amqp_published_total counter</span>
<span class="n">rabbitmq_amqp_published_total</span> <span class="mf">2.0</span>
<span class="c"># HELP rabbitmq_amqp_published_accepted_total</span>
<span class="c"># TYPE rabbitmq_amqp_published_accepted_total counter</span>
<span class="n">rabbitmq_amqp_published_accepted_total</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_published_rejected_total</span>
<span class="c"># TYPE rabbitmq_amqp_published_rejected_total counter</span>
<span class="n">rabbitmq_amqp_published_rejected_total</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_published_released_total</span>
<span class="c"># TYPE rabbitmq_amqp_published_released_total counter</span>
<span class="n">rabbitmq_amqp_published_released_total</span> <span class="mf">1.0</span>
<span class="c"># HELP rabbitmq_amqp_publishers</span>
<span class="c"># TYPE rabbitmq_amqp_publishers gauge</span>
<span class="n">rabbitmq_amqp_publishers</span> <span class="mf">1.0</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="requestresponse"><a class="anchor" href="#requestresponse"></a>Request/Response</h3>
<div class="paragraph">
<p>Request/response with RabbitMQ consists of a requester sending a request message and a responder replying with a response message.
Both the requester and responder are <em>client applications</em> and the messages flow through the broker.
The requester must send a reply-to queue address with the request.
The responder uses this reply-to queue address to send the response.
There must also be a way to correlate a request with its response, this is usually handled with a header that the requester and responder agree on.</p>
</div>
<div class="paragraph">
<p>The library provides requester and responder support classes.
They use sensible defaults and some of the internal mechanics are configurable.
They should meet the requirements of most request/response use cases.
It is still possible to implement one part or the other with regular publishers and consumers for special cases, as this is what the request/response support classes do.</p>
</div>
<div class="paragraph">
<p>Here is how to create a responder instance:</p>
</div>
<div class="listingblock">
<div class="title">Creating a responder</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Responder</span> <span class="n">responder</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">responderBuilder</span><span class="o">()</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="o">.</span><span class="na">requestQueue</span><span class="o">(</span><span class="s">"request-queue"</span><span class="o">)</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">.</span><span class="na">handler</span><span class="o">((</span><span class="n">ctx</span><span class="o">,</span> <span class="n">req</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="nc">String</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">req</span><span class="o">.</span><span class="na">body</span><span class="o">(),</span> <span class="no">UTF_8</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">out</span> <span class="o">=</span> <span class="s">"*** "</span> <span class="o">+</span> <span class="n">in</span> <span class="o">+</span> <span class="s">" ***"</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="no">UTF_8</span><span class="o">));</span> <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="o">}).</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use builder from connection</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the queue to consume requests from (it must exist)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the processing logic</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Create the reply message</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that the responder does not create the queue it waits for requests on.
It must be created beforehand.</p>
</div>
<div class="paragraph">
<p>Here is how to create a requester:</p>
</div>
<div class="listingblock">
<div class="title">Creating a requester</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Requester</span> <span class="n">requester</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">requesterBuilder</span><span class="o">()</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="o">.</span><span class="na">requestAddress</span><span class="o">().</span><span class="na">queue</span><span class="o">(</span><span class="s">"request-queue"</span><span class="o">)</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">.</span><span class="na">requester</span><span class="o">()</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use builder from connection</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the address to send request messages to</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The requester will send its request to the configured destination.
It can be an exchange or a queue, like in the example above.</p>
</div>
<div class="paragraph">
<p>Here is how to send a request:</p>
</div>
<div class="listingblock">
<div class="title">Sending a request</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Message</span> <span class="n">request</span> <span class="o">=</span> <span class="n">requester</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="s">"hello"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="no">UTF_8</span><span class="o">));</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="nc">CompletableFuture</span><span class="o">&lt;</span><span class="nc">Message</span><span class="o">&gt;</span> <span class="n">replyFuture</span> <span class="o">=</span> <span class="n">requester</span><span class="o">.</span><span class="na">publish</span><span class="o">(</span><span class="n">request</span><span class="o">);</span> <i class="conum" data-value="2"></i><b>(2)</b>
<span class="nc">Message</span> <span class="n">reply</span> <span class="o">=</span> <span class="n">replyFuture</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span> <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the message request</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Send the request</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Wait for the reply (synchronously)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Requester#publish(Message)</code> method returns a <code>CompletableFuture&lt;Message&gt;</code> that holds the reply message.
It is then possible to wait for the reply asynchronously or synchronously.</p>
</div>
<div class="paragraph">
<p>The responder has the following behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>when receiving a message request, it calls the processing logic (handler), extracts the correlation ID, calls a reply post-processor if defined, and sends the reply message.</p>
</li>
<li>
<p>if all these operations succeed, the responder accepts the request message (settles it with the <code>ACCEPTED</code> outcome).</p>
</li>
<li>
<p>if any of these operations throws an exception, the responder discards the request message (the message is removed from the request queue and is <a href="https://www.rabbitmq.com/client-libraries/amqp-client-libraries#message-processing-result-outcome">dead-lettered</a> if configured).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The responder uses the following defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it uses the <em>request</em> <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-properties"><code>message-id</code> property</a> for the correlation ID.</p>
</li>
<li>
<p>it assigns the correlation ID (so the <em>request</em> <code>message-id</code> by default) to the <em>reply</em> <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-properties"><code>correlation-id</code> property</a>.</p>
</li>
<li>
<p>it assigns the <em>request</em> <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-properties"><code>reply-to</code> property</a> to the <em>reply</em> <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-properties"><code>to</code> property</a> if it is defined.
This behavior is hardcoded, but it is possible to override it thanks to a reply post-processor.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The requester uses the following defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it uses <a href="https://www.rabbitmq.com/docs/direct-reply-to">direct reply-to</a> if available (RabbitMQ 4.2 or more) for replies if no reply-to queue is set (it falls back to an auto-delete, exclusive queue if direct reply-to is not available)</p>
</li>
<li>
<p>it uses a string-based correlation ID generator, with a fixed random UUID prefix and a strictly monotonic increasing sequence suffix (<code>{UUID}-{sequence}</code>, e.g. <code>6f839461-6b19-47e1-80b3-6be10d899d85-42</code>).
The prefix is different for each <code>Requester</code> instance and the suffix is incremented by one for each request.</p>
</li>
<li>
<p>it sets the <em>request</em> <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-properties"><code>reply-to</code> property</a> to the reply-to queue address (defined by the user or created automatically, see above).</p>
</li>
<li>
<p>it sets the <em>request</em> <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-properties"><code>message-id</code> property</a> to the generated correlation ID.</p>
</li>
<li>
<p>it extracts the correlation ID from the <em>reply</em> <a href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-properties"><code>correlation-id</code> property</a> to correlate a reply with the appropriate request.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the responder will perform expensive work, it can proactively check whether the requester is still present with the <code>Context#isRequesterAlive(Message)</code> method:</p>
</div>
<div class="listingblock">
<div class="title">Checking the requester</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Responder</span> <span class="n">responder</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">responderBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">requestQueue</span><span class="o">(</span><span class="s">"request-queue"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">handler</span><span class="o">((</span><span class="n">ctx</span><span class="o">,</span> <span class="n">req</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">ctx</span><span class="o">.</span><span class="na">isRequesterAlive</span><span class="o">(</span><span class="n">req</span><span class="o">))</span> <span class="o">{</span> <i class="conum" data-value="1"></i><b>(1)</b>
          <span class="nc">String</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">req</span><span class="o">.</span><span class="na">body</span><span class="o">(),</span> <span class="no">UTF_8</span><span class="o">);</span>
          <span class="nc">String</span> <span class="n">out</span> <span class="o">=</span> <span class="s">"*** "</span> <span class="o">+</span> <span class="n">in</span> <span class="o">+</span> <span class="s">" ***"</span><span class="o">;</span>
          <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="no">UTF_8</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
          <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}).</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Check if the requester is still connected</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The responder can check the requester at any time - when a request comes in or even during a long processing - and react accordingly by stopping the processing.
Note each call to <code>Context#isRequesterAlive(Message)</code> implies a request to the broker.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how to customize some of the request/response support mechanics.
Imagine the request <code>message-id</code> property is a critical piece of information and we do not want to use it as the correlation ID.
The request can use the <code>correlation-id</code> property and the responder just has to extract the correlation ID from this property (instead of the <code>message-id</code> property by default).
Let&#8217;s also use a random UUID for the correlation ID generation (avoid doing this in production: this is OK in terms of uniqueness but not optimal in terms of performance because randomness is not cheap).</p>
</div>
<div class="paragraph">
<p>Here is how to declare the requester:</p>
</div>
<div class="listingblock">
<div class="title">Customizing the requester</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span> <span class="n">replyToQueue</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">management</span><span class="o">().</span><span class="na">queue</span><span class="o">()</span>
    <span class="o">.</span><span class="na">autoDelete</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">exclusive</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
    <span class="o">.</span><span class="na">declare</span><span class="o">().</span><span class="na">name</span><span class="o">();</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="nc">Requester</span> <span class="n">requester</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">requesterBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">correlationIdSupplier</span><span class="o">(</span><span class="nl">UUID:</span><span class="o">:</span><span class="n">randomUUID</span><span class="o">)</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">.</span><span class="na">requestPostProcessor</span><span class="o">((</span><span class="n">msg</span><span class="o">,</span> <span class="n">corrId</span><span class="o">)</span> <span class="o">-&gt;</span>
        <span class="n">msg</span><span class="o">.</span><span class="na">correlationId</span><span class="o">(</span><span class="n">corrId</span><span class="o">)</span> <i class="conum" data-value="3"></i><b>(3)</b>
           <span class="o">.</span><span class="na">replyToAddress</span><span class="o">().</span><span class="na">queue</span><span class="o">(</span><span class="n">replyToQueue</span><span class="o">).</span><span class="na">message</span><span class="o">())</span> <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="o">.</span><span class="na">replyToQueue</span><span class="o">(</span><span class="n">replyToQueue</span><span class="o">)</span>
    <span class="o">.</span><span class="na">requestAddress</span><span class="o">().</span><span class="na">queue</span><span class="o">(</span><span class="s">"request-queue"</span><span class="o">)</span> <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="o">.</span><span class="na">requester</span><span class="o">()</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declare the reply-to queue</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use a random UUID as correlation ID</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use the <code>correlation-id</code> property for the request</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Set the <code>reply-to</code> property</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Set the address to send request messages to</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We just have to tell the responder to get the correlation ID from the request <code>correlation-id</code> property:</p>
</div>
<div class="listingblock">
<div class="title">Customizing the responder</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Responder</span> <span class="n">responder</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">responderBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">correlationIdExtractor</span><span class="o">(</span><span class="nl">Message:</span><span class="o">:</span><span class="n">correlationId</span><span class="o">)</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="o">.</span><span class="na">requestQueue</span><span class="o">(</span><span class="s">"request-queue"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">handler</span><span class="o">((</span><span class="n">ctx</span><span class="o">,</span> <span class="n">req</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">req</span><span class="o">.</span><span class="na">body</span><span class="o">(),</span> <span class="no">UTF_8</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">out</span> <span class="o">=</span> <span class="s">"*** "</span> <span class="o">+</span> <span class="n">in</span> <span class="o">+</span> <span class="s">" ***"</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="no">UTF_8</span><span class="o">));</span>
    <span class="o">}).</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Get the correlation ID from the request <code>correlation-id</code> property</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="micrometer-observation"><a class="anchor" href="#micrometer-observation"></a>Appendix A: Micrometer Observation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to use <a href="https://micrometer.io/docs/observation">Micrometer Observation</a> to instrument publishing and consuming in the AMQP Java client.
Micrometer Observation provides <a href="https://spring.io/blog/2022/10/12/observability-with-spring-boot-3">metrics, tracing, and log correlation with one single API</a>.</p>
</div>
<div class="paragraph">
<p>The AMQP Java client provides an <code>ObservationCollector</code> abstraction and an implementation for Micrometer Observation.
The following snippet shows how to create and set up the Micrometer <code>ObservationCollector</code> implementation with an existing <code>ObservationRegistry</code>:</p>
</div>
<div class="listingblock">
<div class="title">Configuring Micrometer Observation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AmqpEnvironmentBuilder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">observationCollector</span><span class="o">(</span><span class="k">new</span> <span class="nc">MicrometerObservationCollectorBuilder</span><span class="o">()</span>  <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="o">.</span><span class="na">registry</span><span class="o">(</span><span class="n">observationRegistry</span><span class="o">).</span><span class="na">build</span><span class="o">())</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Configure Micrometer <code>ObservationCollector</code> with builder</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set Micrometer <code>ObservationRegistry</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The next sections document the conventions, spans, and metrics made available by the instrumentation.
They are automatically generated from the source code with the <a href="https://github.com/micrometer-metrics/micrometer-docs-generator">Micrometer documentation generator</a>.</p>
</div>
<div class="sect2">
<h3 id="observability-conventions"><a class="anchor" href="#observability-conventions"></a>Observability - Conventions</h3>
<div class="paragraph">
<p>Below you can find a list of all <code>GlobalObservationConvention</code> and <code>ObservationConvention</code> declared by this project.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. ObservationConvention implementations</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ObservationConvention Class Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Applicable ObservationContext Class Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.rabbitmq.client.amqp.observation.micrometer.DefaultProcessObservationConvention</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DeliverContext</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.rabbitmq.client.amqp.observation.micrometer.DeliverObservationConvention</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DeliverContext</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.rabbitmq.client.amqp.observation.micrometer.DefaultPublishObservationConvention</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PublishContext</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.rabbitmq.client.amqp.observation.micrometer.PublishObservationConvention</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PublishContext</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="observability-spans"><a class="anchor" href="#observability-spans"></a>Observability - Spans</h3>
<div class="paragraph">
<p>Below you can find a list of all spans declared by this project.</p>
</div>
<div class="sect3">
<h4 id="observability-spans-process-observation"><a class="anchor" href="#observability-spans-process-observation"></a>Process Observation Span</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Observation for processing a message.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Span name</strong> <code>rabbitmq.amqp.process</code> (defined by convention class <code>com.rabbitmq.client.amqp.observation.micrometer.DefaultProcessObservationConvention</code>).</p>
</div>
<div class="paragraph">
<p>Fully qualified name of the enclosing class <code>com.rabbitmq.client.amqp.observation.micrometer.AmqpObservationDocumentation</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Tag Keys</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>messaging.operation</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the kind of messaging operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>messaging.system</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the messaging system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>net.protocol.name</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the protocol (AMQP).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>net.protocol.version</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the protocol version (1.0).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="observability-spans-publish-observation"><a class="anchor" href="#observability-spans-publish-observation"></a>Publish Observation Span</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Observation for publishing a message.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Span name</strong> <code>rabbitmq.amqp.publish</code> (defined by convention class <code>com.rabbitmq.client.amqp.observation.micrometer.DefaultPublishObservationConvention</code>).</p>
</div>
<div class="paragraph">
<p>Fully qualified name of the enclosing class <code>com.rabbitmq.client.amqp.observation.micrometer.AmqpObservationDocumentation</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Tag Keys</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>messaging.operation</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the kind of messaging operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>messaging.system</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the messaging system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>net.protocol.name</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the protocol (AMQP).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>net.protocol.version</code> <em>(required)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying the protocol version (1.0).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="observability-metrics"><a class="anchor" href="#observability-metrics"></a>Observability - Metrics</h3>
<div class="paragraph">
<p>Below you can find a list of all metrics declared by this project.</p>
</div>
<div class="sect3">
<h4 id="observability-metrics-process-observation"><a class="anchor" href="#observability-metrics-process-observation"></a>Process Observation</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Observation for processing a message.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Metric name</strong> <code>rabbitmq.amqp.process</code> (defined by convention class <code>com.rabbitmq.client.amqp.observation.micrometer.DefaultProcessObservationConvention</code>). <strong>Type</strong> <code>timer</code>.</p>
</div>
<div class="paragraph">
<p><strong>Metric name</strong> <code>rabbitmq.amqp.process.active</code> (defined by convention class <code>com.rabbitmq.client.amqp.observation.micrometer.DefaultProcessObservationConvention</code>). <strong>Type</strong> <code>long task timer</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
KeyValues that are added after starting the Observation might be missing from the *.active metrics.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Micrometer internally uses <code>nanoseconds</code> for the baseunit. However, each backend determines the actual baseunit. (i.e. Prometheus uses seconds)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Fully qualified name of the enclosing class <code>com.rabbitmq.client.amqp.observation.micrometer.AmqpObservationDocumentation</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Low cardinality Keys</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Description</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>messaging.operation</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the kind of messaging operation.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>messaging.system</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the messaging system.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>net.protocol.name</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the protocol (AMQP).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>net.protocol.version</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the protocol version (1.0).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="observability-metrics-publish-observation"><a class="anchor" href="#observability-metrics-publish-observation"></a>Publish Observation</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Observation for publishing a message.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Metric name</strong> <code>rabbitmq.amqp.publish</code> (defined by convention class <code>com.rabbitmq.client.amqp.observation.micrometer.DefaultPublishObservationConvention</code>). <strong>Type</strong> <code>timer</code>.</p>
</div>
<div class="paragraph">
<p><strong>Metric name</strong> <code>rabbitmq.amqp.publish.active</code> (defined by convention class <code>com.rabbitmq.client.amqp.observation.micrometer.DefaultPublishObservationConvention</code>). <strong>Type</strong> <code>long task timer</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
KeyValues that are added after starting the Observation might be missing from the *.active metrics.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Micrometer internally uses <code>nanoseconds</code> for the baseunit. However, each backend determines the actual baseunit. (i.e. Prometheus uses seconds)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Fully qualified name of the enclosing class <code>com.rabbitmq.client.amqp.observation.micrometer.AmqpObservationDocumentation</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Low cardinality Keys</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Description</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>messaging.operation</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the kind of messaging operation.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>messaging.system</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the messaging system.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>net.protocol.name</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the protocol (AMQP).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>net.protocol.version</code> <em>(required)</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A string identifying the protocol version (1.0).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.8.0-SNAPSHOT<br>
Last updated 2025-09-23 06:07:32 UTC
</div>
</div>
</body>
</html>